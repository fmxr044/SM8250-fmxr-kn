****************************
****************************
 APatch Boot Image Patcher
****************************
- Patching kernel
+ ./kptools -p -i kernel.ori -S a149189136A -k kpimg -o kernel true -E 'AuditPatch KPM' -V pre-kernel-init -T kpm -E ditpro-kpm-read/write -V pre-kernel-init -T kpm
[+] kernel image_size: 0x03083d30
[+] kernel uefi header: false
[+] kernel load_offset: 0x00080000
[+] kernel kernel_size: 0x03b14000
[+] kernel page_shift: 12
[+] patched kernel image ...
[+] linux_banner 1: Linux version 4.19.157-perf-g5342241c9c65 (builder@pangu-build-component-vendor-295438-2fxw6-c8ds7-1cr82) (clang version 10.0.7 for Android NDK, GNU ld (binutils-2.27-bd24d23f) 2.27.0.20170315) #1 SMP PREEMPT Mon Sep 18 13:26:42 UTC 2023
[+] linux_banner offset: 0x1580018
[+] linux_banner 2: Linux version 4.19.157-perf-g5342241c9c65 (builder@pangu-build-component-vendor-295438-2fxw6-c8ds7-1cr82) (clang version 10.0.7 for Android NDK, GNU ld (binutils-2.27-bd24d23f) 2.27.0.20170315) #1 SMP PREEMPT Mon Sep 18 13:26:42 UTC 2023
[+] linux_banner offset: 0x2180038
[+] kernel version major: 4, minor: 19, patch: 157
[+] kallsyms_token_table offset: 0x023cfc00
[+] endian: little
[+] kallsyms_token_index offset: 0x023d0000
[+] arm64 relocation kernel_va: 0xffffff8008080000
[+] arm64 relocation table range: [0x02871e18, 0x02b755c8), count: 0x00020252
[+] apply 0x00020246 relocation entries
[+] kallsyms_markers range: [0x023ceb00, 0x023cfb88), count: 0x00000210
[+] approximate kallsyms_offsets range: [0x021805f0, 0x02204734) count: 0x00021051
[+] kallsyms_names offset: 0x02204a00
[+] kallsyms_num_syms offset: 0x02204900, value: 0x0002104d
[+] names table linux_banner index: 0x0000de3a
[+] linux_banner index: 0
[+] kallsyms_offsets offset: 0x02180600
[+] pid_vnr: type: T, offset: 0x000685c0
[+] pid_vnr verfied sp_el0, insn: 0xd5384108
[+] layout kimg: 0x0,0x3045010, kpimg: 0x3046000,0x2c100, extra: 0x3072100,0x11c30, end: 0x3083d30, start: 0x3b14000
[+] kpimg version: c02
[+] kpimg compile time: 14:48:49 Nov 11 2025
[+] kpimg config: android, release
[+] tcp_init_sock: type: T, offset: 0x01256428
[+] map_start: 0x1256430, max_size: 0x800
[+] kallsyms_lookup_name: type: T, offset: 0x001263a0
[+] printk: type: T, offset: 0x000d8c88
[+] memblock_reserve: type: T, offset: 0x0021b108
[+] memblock_free: type: T, offset: 0x0021b070
[+] memblock_mark_nomap: type: T, offset: 0x0021b3b0
[?] no symbol: memblock_phys_alloc_try_nid
[+] memblock_virt_alloc_try_nid: type: T, offset: 0x027a20b8
[+] memblock_alloc_try_nid: type: T, offset: 0x027a1d4c
[+] panic: type: T, offset: 0x0003f2a4
[+] rest_init: type: t, offset: 0x014831d8
[+] kernel_init: type: t, offset: 0x014832b8
[?] no symbol: report_cfi_failure
[?] no symbol: __cfi_slowpath_diag
[?] no symbol: __cfi_slowpath
[+] copy_process: type: t, offset: 0x0003c680
[+] avc_denied: type: t, offset: 0x0042a7e8
[+] slow_avc_audit: type: T, offset: 0x00429758
[+] input_handle_event: type: t, offset: 0x009ef798
[+] root superkey hash: c02c8b7944f5b7f56db1f54a5f98ad12e751016deeb47737cec824958808f187
[+] paging_init: type: T, offset: 0x02788368
[+] embedding kpm, name: AuditPatch KPM, priority: 0, event: pre-kernel-init, args: , size: 0x80+0x0+0xde0
[+] embedding kpm, name: ditpro-kpm-read/write, priority: 0, event: pre-kernel-init, args: , size: 0x80+0x0+0x10cd0
[+] patch done: kernel
+ patch_rc=0
+ set +x
- Repacking boot image
- Flashing new boot image
- Successfully Flashed!
- Reboot to finish the installation...
****************************


****************************
****************************
 APatch Boot Image Patcher
****************************
- Backing boot.img 
- Patching kernel
+ ./kptools -p -i kernel.ori -S a149189136A -k kpimg -o kernel true
[-] /home/runner/work/KernelPatch/KernelPatch/tools/patch.c:392/patch_update_img(); analyze_kallsym_info error
[+] kernel image_size: 0x0297d010
[+] kernel uefi header: false
[+] kernel load_offset: 0x00080000
[+] kernel kernel_size: 0x034b9000
[+] kernel page_shift: 12
[+] new kernel image ...
[+] linux_banner 1: Linux version 4.19.337-perf+ (builder@pangu-build-component-vendor-295438-2fxw6-c8ds7-1cr82) (Android (12414805, +pgo, +bolt, +lto, +mlgo, based on r536225) clang version 19.0.1 (https://android.googlesource.com/toolchain/llvm-project b3a530ec6537146650e42be89f1089e9a3588460), LLD 19.0.1) #1 SMP PREEMPT Mon Jan 12 02:18:07 UTC 2026
[+] linux_banner offset: 0x1f548a3
[+] kernel version major: 4, minor: 19, patch: 255
[+] kallsyms_token_table offset: 0x01db49a8
[+] endian: little
[+] kallsyms_token_index offset: 0x01db4ce0
[+] arm64 relocation kernel_va: 0xffffff8010000000
[+] arm64 relocation table range: [0x0246c8e0, 0x026ea680), count: 0x0001a93c
[?] bad rela offset: 0xffffff801297e450
[?] find kallsyms_markers error
[+] kallsyms_markers range: [0x01db4690, 0x01db49a4), count: 0x000000c4
[+] approximate kallsyms_offsets range: [0x01ce2618, 0x01ce2660) count: 0x00000012
[+] kallsyms_names offset: 0x01d13c20
[?] can't find kallsyms_num_syms, try: 0x00000008
[?] no linux_banner, CONFIG_KALLSYMS_ALL=n
[+] names table vector index: 0x00000013, pid_vnr index: 0x000004a7
[-] /home/runner/work/KernelPatch/KernelPatch/tools/kallsym.c:739/correct_addresses_or_offsets_by_vectors(); can't locate vectors
[+] kallsyms_markers range: [0x01db4690, 0x01db49a4), count: 0x000000c4
[+] approximate kallsyms_offsets range: [0x01ce2618, 0x01ce2660) count: 0x00000012
[+] kallsyms_names offset: 0x01d13c20
[?] can't find kallsyms_num_syms, try: 0x00000008
[?] no linux_banner, CONFIG_KALLSYMS_ALL=n
[+] names table vector index: 0x00000013, pid_vnr index: 0x000004a7
[-] /home/runner/work/KernelPatch/KernelPatch/tools/kallsym.c:739/correct_addresses_or_offsets_by_vectors(); can't locate vectors
+ patch_rc=1
+ set +x
- Patch kernel error: 1
- Reboot to finish the installation...
****************************